
<!DOCTYPE html>
<html>
  <head>    
    <meta charset="utf-8">

    <title> Game Play - Data Visualization with D3.js </title>

    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <script src="https://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="https://d3js.org/d3.v2.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<script src="https://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>


  <!-- Note: I made good use of the sample code provided by the D3JS community and extended it to fit my needs to create this simple dashboard -->
<style type="text/css">

body{
      font-family: "Open Sans", Helvetica, Arial, sans-serif;
    }

#pieChart {    
  position:absolute;
  top:200px;
  left:50px;
  width:400px;
  height: 400px; 
}

#lineChart {    
  position:absolute;
  top:200px;
  left:650px;
  height: 150px;
}

#barChart {
  position:absolute;
  top: 360px;
  left: 600px;
  height: 300px;
}

.slice {
   font-size: 11pt;
   font-family: Verdana;
   fill: white; //svg specific - instead of color
   font-weight: bold; 
      } 

/*for line chart*/
.axis path, .axis line {
    fill: none;
    stroke: black;
    shape-rendering: crispEdges; //The shape-rendering property is an SVG attribute, used here to make sure our axis and its tick mark lines are pixel-perfect. 
}

.line {
  fill: none;
  stroke-width: 3px;
}

.dot {
  stroke-width: 1.5px;
  }
        
.text {
  font: 10px sans-serif;
  pointer-events: none;
  text-shadow: 0 1px 0 #fff, 1px 0 0 #fff, 0 -1px 0 #fff, -1px 0 0 #fff;
}
.axis text {
    font-family: Verdana;
    font-size: 11px;
}

.title {
   font-family: Verdana;
    font-size: 15px;  
}

.xAxis {
    font-family: verdana;
    font-size: 11px;
    font-weight: bold; 
    fill: black;
}  

.yAxis {
    font-family: verdana;
    font-size: 11px;
    font-weight: bold; 
    fill: black;
}

div.tooltip { 
    position: absolute;     
    text-align: center;     
    width: 150px;          
    height: 35px;         
    padding: 2px;       
    font: 13px sans-serif;
    font-weight: bold;    
    background: #FFFFFF; 
    border: 0px;    
    border-radius: 8px;     
    pointer-events: none;     
}

/*.h1 {
  margin-left: 30 !important;
}*/
  
table {
  border-collapse:collapse;
  border: 0px;  
  font-family: Verdana; 
  color: #5C5558;
  font-size: 12px;
  text-align: right;      
}

td {
  padding-left: 10px;   
}

#lineChartTitle1 {
  font-family: Verdana;
  font-size  : 15px;
  fill       : black;
  font-weight: bold;
  text-anchor: middle;
}

#lineChartTitle2 {
  font-family: Verdana;
  font-size  : 14px;
  fill       : grey;
  text-anchor: middle;
  font-weight: bold;
}
.d3-tip {
  line-height: 1;
  font-weight: bold;
  padding: 12px;
  background: rgba(0,0 , 0, 0.9);
  color: white;
  border-radius: 2px;
}

/* Creates a small triangle extender for the tooltip */
.d3-tip:after {
  box-sizing: border-box;
  display: inline;
  font-size: 10px;
  width: 100%;
  line-height: 1;
  color: rgba(0, 0, 0, 0.8);
  content: "\25BC";
  position: absolute;
  text-align: center;
}

/* Style northward tooltips differently */
.d3-tip.n:after {
  margin: -1px 0 0 0;
  top: 100%;
  left: 0;
}
         
    </style>
  </head>


<body>
<div id="canvas-svg">
    <div>
      <h1 class='animated tada'> <pre style='font-family: "Open Sans"; font-size:inherit'> Video Games Sales dashboard </pre></h1>
  </div>
  <div>
    <h4> Link to the dataset: https://www.kaggle.com/gregorut/videogamesales</h4>
  </div>
  <div>
      <div id="pieChart"></div>
      <div id="barChart"></div>  
      <div id="lineChart"></div>
    </div>

</div>

<script type="text/javascript">
    
/*
################ FORMATS ##################
-------------------------------------------
*/


var   formatAsPercentage = d3.format("%"),
    formatAsPercentage1Dec = d3.format(".1%"),
    formatAsInteger = d3.format(","),
    fsec = d3.time.format("%S s"),
    fmin = d3.time.format("%M m"),
    fhou = d3.time.format("%H h"),
    fwee = d3.time.format("%a"),
    fdat = d3.time.format("%d d"),
    fmon = d3.time.format("%b")
    ;

/*
############# PIE CHART ###################
-------------------------------------------
*/



function dsPieChart(){
/*
 var dataset = [
      {category: "Sam", measure: 0.30},
        {category: "Peter", measure: 0.25},
        {category: "Jenn", measure: 0.15},
        {category: "Rick", measure: 0.05},
        {category: "Laura", measure: 0.18},
        {category: "Mike", measure:0.04},
        {category: "Steve", measure: 0.03}
        ]
        ;
*/
var dataset = [
{ category :'Nintendo', measure: 0.28},
{ category :'Electronic Arts', measure: 0.20},
{ category :'Activision', measure: 0.13},
{ category :'Sony Entertainment', measure: 0.11},
{ category :'Ubisoft', measure: 0.09},
{ category :'Take 2 Interactive', measure: 0.06},
{ category :'Konami', measure: 0.05},
{ category :'Sega', measure: 0.041},
{ category :'Namco Bandai', measure: 0.04}
];

  var width = 500,
       height = 500,
       outerRadius = Math.min(width, height) / 2,
       innerRadius = outerRadius * .999,   
       // for animation
       innerRadiusFinal = outerRadius * .5,
       innerRadiusFinal3 = outerRadius* .45,
       color = d3.scale.category20()    //builtin range of colors
       ;
      
  var vis = d3.select("#pieChart")
       .append("svg:svg")              //create the SVG element inside the <body>
       .data([dataset])                   //associate our data with the document
           .attr("width", width)           //set the width and height of our visualization (these will be attributes of the <svg> tag
           .attr("height", height)
          .append("svg:g")                //make a group to hold our pie chart
           .attr("transform", "translate(" + outerRadius + "," + outerRadius + ")")    //move the center of the pie chart from 0, 0 to radius, radius
        ;
        
   var arc = d3.svg.arc()              //this will create <path> elements for us using arc data
          .outerRadius(outerRadius).innerRadius(innerRadius);
   
   // for animation
   var arcFinal = d3.svg.arc().innerRadius(innerRadiusFinal).outerRadius(outerRadius);
  var arcFinal3 = d3.svg.arc().innerRadius(innerRadiusFinal3).outerRadius(outerRadius);

   var pie = d3.layout.pie()           //this will create arc data for us given a list of values
        .value(function(d) { return d.measure; });    //we must tell it out to access the value of each element in our data array

   var arcs = vis.selectAll("g.slice")     //this selects all <g> elements with class slice (there aren't any yet)
        .data(pie)                          //associate the generated pie data (an array of arcs, each having startAngle, endAngle and value properties) 
        .enter()                            //this will create <g> elements for every "extra" data element that should be associated with a selection. The result is creating a <g> for every object in the data array
            .append("svg:g")                //create a group to hold each slice (we will have a <path> and a <text> element associated with each slice)
               .attr("class", "slice")    //allow us to style things in the slices (like text)
               .on("mouseover", mouseover)
            .on("mouseout", mouseout)
            .on("click", up)
            ;
            
        arcs.append("svg:path")
               .attr("fill", function(d, i) { return color(i); } ) //set the color for each slice to be chosen from the color function defined above
               .attr("d", arc)     //this creates the actual SVG path using the associated data (pie) with the arc drawing function
          .append("svg:title") //mouseover title showing the figures
           .text(function(d) { return d.data.category + ": " + formatAsPercentage(d.data.measure); });      

        d3.selectAll("g.slice").selectAll("path").transition()
          .duration(750)
          .delay(10)
          .attr("d", arcFinal )
          ;

 // Add a legendLabel to each arc slice...
/*    arcs.append("svg:text")
      .attr("transform", function(d) { //set the label's origin to the center of the arc
        //we have to make sure to set these before calling arc.centroid
        d.outerRadius = outerRadius + 50; // Set Outer Coordinate
        d.innerRadius = outerRadius + 45; // Set Inner Coordinate
        return "translate(" + arc.centroid(d) + ")";
      })
      .attr("text-anchor", "middle") //center the text on it's origin
      .style("fill", "Purple")
      .style("font", "bold 12px Arial")
      .text(function(d, i) { return d.data.category; }); */
  
    // Add a label to the larger arcs, translated to the arc centroid and rotated.
    // source: http://bl.ocks.org/1305337#index.html
    arcs.filter(function(d) { return d.endAngle - d.startAngle > .2; })
        .append("svg:text")
        .attr("dy", ".35em")
        .attr("text-anchor", "middle")
        .attr("transform", function(d) { return "translate(" + arcFinal.centroid(d) + ")rotate(" + angle(d) + ")"; })
        //.text(function(d) { return formatAsPercentage(d.value); })
        .text(function(d) { return d.data.category; })
        ;
     
     // Computes the label angle of an arc, converting from radians to degrees.
    function angle(d) {
        var a = (d.startAngle + d.endAngle) * 90 / Math.PI - 90;
        return a > 90 ? a - 180 : a;
    }
        
    
    // Pie chart title      
    vis.append("svg:text")
        .attr("dy", ".35em")
        .attr("text-anchor", "middle")
        .text("Market Share By Publisher")
        .attr("class","title")
        ;       


    
  function mouseover() {
    d3.select(this).select("path").transition()
        .duration(750)
              //.attr("stroke","red")
              //.attr("stroke-width", 1.5)
              .attr("d", arcFinal3)
              ;
  }
  
  function mouseout() {
    d3.select(this).select("path").transition()
        .duration(750)
              //.attr("stroke","blue")
              //.attr("stroke-width", 1.5)
              .attr("d", arcFinal)
              ;
  }
  
  function up(d, i) {
  
        /* update bar chart when user selects piece of the pie chart */
        //updateBarChart(dataset[i].category);
        updateBarChart(d.data.category, color(i));
        updateLineChart(d.data.category, color(i));
       
  }
}

dsPieChart();


function sunburst_pie(){

  //var margin = {top: 350, right: 480, bottom: 350, left: 480},
  //radius = Math.min(margin.top, margin.right, margin.bottom, margin.left) - 10;

  var hue = d3.scale.category10();

  var luminance = d3.scale.sqrt()
      .domain([0, 1e6])
      .clamp(true)
      .range([90, 20]);

}

/*
############# BAR CHART ###################
-------------------------------------------
*/


/*
var datasetBarChart = [
{ group: "All", category: "Oranges", measure: 63850.4963 }, 
{ group: "All", category: "Apples", measure: 78258.0845 }, 
{ group: "All", category: "Grapes", measure: 60610.2355 }, 
{ group: "All", category: "Figs", measure: 30493.1686 }, 
{ group: "All", category: "Mangos", measure: 56097.0151 }, 
{ group: "Sam", category: "Oranges", measure: 19441.5648 }, 
{ group: "Sam", category: "Apples", measure: 25922.0864 }, 
{ group: "Sam", category: "Grapes", measure: 9720.7824 }, 
{ group: "Sam", category: "Figs", measure: 6480.5216 }, 
{ group: "Sam", category: "Mangos", measure: 19441.5648 }, 
{ group: "Peter", category: "Oranges", measure: 22913.2728 }, 
{ group: "Peter", category: "Apples", measure: 7637.7576 }, 
{ group: "Peter", category: "Grapes", measure: 23549.7526 }, 
{ group: "Peter", category: "Figs", measure: 1909.4394 }, 
{ group: "Peter", category: "Mangos", measure: 7637.7576 }, 
{ group: "Jenn", category: "Oranges", measure: 1041.5124 }, 
{ group: "Jenn", category: "Apples", measure: 2430.1956 }, 
{ group: "Jenn", category: "Grapes", measure: 15275.5152 }, 
{ group: "Jenn", category: "Figs", measure: 4166.0496 }, 
{ group: "Jenn", category: "Mangos", measure: 11803.8072 }, 
{ group: "Rick", category: "Oranges", measure: 7406.3104 }, 
{ group: "Rick", category: "Apples", measure: 2545.9192 }, 
{ group: "Rick", category: "Grapes", measure: 1620.1304 }, 
{ group: "Rick", category: "Figs", measure: 8563.5464 }, 
{ group: "Rick", category: "Mangos", measure: 3008.8136 }, 
{ group: "Laura", category: "Oranges", measure: 7637.7576 }, 
{ group: "Laura", category: "Apples", measure: 35411.4216 }, 
{ group: "Laura", category: "Grapes", measure: 8332.0992 }, 
{ group: "Laura", category: "Figs", measure: 6249.0744 }, 
{ group: "Laura", category: "Mangos", measure: 11803.8072 }, 
{ group: "Mike", category: "Oranges", measure: 3182.399 }, 
{ group: "Mike", category: "Apples", measure: 867.927 }, 
{ group: "Mike", category: "Grapes", measure: 1808.18125 }, 
{ group: "Mike", category: "Figs", measure: 795.59975 }, 
{ group: "Mike", category: "Mangos", measure: 578.618 }, 
{ group: "Steve", category: "Oranges", measure: 2227.6793 }, 
{ group: "Steve", category: "Apples", measure: 3442.7771 }, 
{ group: "Steve", category: "Grapes", measure: 303.77445 }, 
{ group: "Steve", category: "Figs", measure: 2328.93745 }, 
{ group: "Steve", category: "Mangos", measure: 1822.6467 }, 
]
;*/

var datasetBarChart = [
{group:'Take 2 Interactive',category :'2000', measure: 3.4,sales:'Global Sale : 3.4million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2001', measure: 7.33,sales:'Global Sale : 7.33million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2002', measure: 4.14,sales:'Global Sale : 4.14million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2003', measure: 8.08,sales:'Global Sale : 8.08million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2004', measure: 3.3,sales:'Global Sale : 3.3million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2005', measure: 18.57,sales:'Global Sale : 18.57million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2006', measure: 15.51,sales:'Global Sale : 15.51million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2007', measure: 15.71,sales:'Global Sale : 15.71million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2008', measure: 35.16,sales:'Global Sale : 35.16million $<br>',msg:'GTA IV became the best selling game of 2008',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2009', measure: 15.67,sales:'Global Sale : 15.67million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2010', measure: 29.24,sales:'Global Sale : 29.24million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2011', measure: 14.8,sales:'Global Sale : 14.8million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2012', measure: 18.51,sales:'Global Sale : 18.51million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2013', measure: 14.63,sales:'Global Sale : 14.63million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2014', measure: 18.28,sales:'Global Sale : 18.28million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Take 2 Interactive',category :'2015', measure: 11.18,sales:'Global Sale : 11.18million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2000', measure: 17.98,sales:'Global Sale : 17.98million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2001', measure: 20.26,sales:'Global Sale : 20.26million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2002', measure: 19.45,sales:'Global Sale : 19.45million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2003', measure: 20.12,sales:'Global Sale : 20.12million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2004', measure: 23.5,sales:'Global Sale : 23.5million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2005', measure: 21.93,sales:'Global Sale : 21.93million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2006', measure: 29.46,sales:'Global Sale : 29.46million $<br>',msg:'Motorstorm became the best selling game for PS3 of 2006',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2007', measure: 32.6,sales:'Global Sale : 32.6million $<br>',msg:'Gran Turismo 5 and God of War 2 were the best selling games of 2007',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2008', measure: 20.72,sales:'Global Sale : 20.72million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2009', measure: 29.8,sales:'Global Sale : 29.8million $<br>',msg:'Gran Turismo (PSP) became the best selling game of PSP',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2010', measure: 24.12,sales:'Global Sale : 24.12million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2011', measure: 20.57,sales:'Global Sale : 20.57million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2012', measure: 11.38,sales:'Global Sale : 11.38million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2013', measure: 8.97,sales:'Global Sale : 8.97million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2014', measure: 13.6,sales:'Global Sale : 13.6million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sony Entertainment',category :'2015', measure: 6.54,sales:'Global Sale : 6.54million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2000', measure: 6.29,sales:'Global Sale : 6.29million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2001', measure: 13.46,sales:'Global Sale : 13.46million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2002', measure: 9.43,sales:'Global Sale : 9.43million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2003', measure: 11.07,sales:'Global Sale : 11.07million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2004', measure: 15.97,sales:'Global Sale : 15.97million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2005', measure: 10.86,sales:'Global Sale : 10.86million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2006', measure: 10.21,sales:'Global Sale : 10.21million $<br>',msg:'Metal Gear Solid 3 : Snake Eater was a success, both commercially and critically',msg2:'',cond:'yes'},
{group:'Konami',category :'2007', measure: 13.58,sales:'Global Sale : 13.58million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2008', measure: 21.79,sales:'Global Sale : 21.79million $<br>',msg:'Metal Gear Solid 4 was so successful that it boosted the sales of PS3',msg2:'',cond:'yes'},
{group:'Konami',category :'2009', measure: 13.81,sales:'Global Sale : 13.81million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2010', measure: 16.13,sales:'Global Sale : 16.13million $<br>',msg:'Castlevania: Lords of Shadow was a commercial success',msg2:'',cond:'yes'},
{group:'Konami',category :'2011', measure: 7.85,sales:'Global Sale : 7.85million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2012', measure: 6.41,sales:'Global Sale : 6.41million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2013', measure: 3.9,sales:'Global Sale : 3.9million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2014', measure: 3.78,sales:'Global Sale : 3.78million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Konami',category :'2015', measure: 3.48,sales:'Global Sale : 3.48million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2000', measure: 8.76,sales:'Global Sale : 8.76million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2001', measure: 19.46,sales:'Global Sale : 19.46million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2002', measure: 23.86,sales:'Global Sale : 23.86million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2003', measure: 26.56,sales:'Global Sale : 26.56million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2004', measure: 26.32,sales:'Global Sale : 26.32million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2005', measure: 19.29,sales:'Global Sale : 19.29million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2006', measure: 22.36,sales:'Global Sale : 22.36million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2007', measure: 30.95,sales:'Global Sale : 30.95million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2008', measure: 27.42,sales:'Global Sale : 27.42million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2009', measure: 28.76,sales:'Global Sale : 28.76million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2010', measure: 19.65,sales:'Global Sale : 19.65million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2011', measure: 23.99,sales:'Global Sale : 23.99million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2012', measure: 5.31,sales:'Global Sale : 5.31million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'THQ',category :'2013', measure: 0.0,sales:'Global Sale : 0.0million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Activision',category :'2000', measure: 9.8,sales:'Global Sale : 9.8million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Activision',category :'2001', measure: 14.18,sales:'Global Sale : 14.18million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Activision',category :'2002', measure: 21.46,sales:'Global Sale : 21.46million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Activision',category :'2003', measure: 17.48,sales:'Global Sale : 17.48million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Activision',category :'2004', measure: 32.95,sales:'Global Sale : 32.95million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Activision',category :'2005', measure: 32.72,sales:'Global Sale : 32.72million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Activision',category :'2006', measure: 14.69,sales:'Global Sale : 14.69million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Activision',category :'2007', measure: 54.25,sales:'Global Sale : 54.25million $<br>',msg:'Call of Duty 4 : MW became the top selling game of 2007',msg2:'',cond:'yes'},
{group:'Activision',category :'2008', measure: 60.04,sales:'Global Sale : 60.04million $<br>',msg:'Call of Duty : World at War was commerciall successes',msg2:'',cond:'yes'},
{group:'Activision',category :'2009', measure: 64.55,sales:'Global Sale : 64.55million $<br>',msg:'Call of Duty : MW2 became the second best selling game of all time',msg2:'',cond:'yes'},
{group:'Activision',category :'2010', measure: 48.75,sales:'Global Sale : 48.75million $<br>',msg:'Call of Duty : Black ops sold over 5 million copies in 24 hours',msg2:'',cond:'yes'},
{group:'Activision',category :'2011', measure: 23.52,sales:'Global Sale : 23.52million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Activision',category :'2012', measure: 39.22,sales:'Global Sale : 39.22million $<br>',msg:'Call of duty : Black ops 2 became the second-best selling game of 2012',msg2:'',cond:'yes'},
{group:'Activision',category :'2013', measure: 33.28,sales:'Global Sale : 33.28million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Activision',category :'2014', measure: 36.88,sales:'Global Sale : 36.88million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Activision',category :'2015', measure: 21.39,sales:'Global Sale : 21.39million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2000', measure: 27.66,sales:'Global Sale : 27.66million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2001', measure: 38.3,sales:'Global Sale : 38.3million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2002', measure: 32.46,sales:'Global Sale : 32.46million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2003', measure: 31.19,sales:'Global Sale : 31.19million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2004', measure: 50.16,sales:'Global Sale : 50.16million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2005', measure: 102.71,sales:'Global Sale : 102.71million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2006', measure: 92.86,sales:'Global Sale : 92.86million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2007', measure: 81.46,sales:'Global Sale : 81.46million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2008', measure: 55.4,sales:'Global Sale : 55.4million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2009', measure: 95.89,sales:'Global Sale : 95.89million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2010', measure: 45.75,sales:'Global Sale : 45.75million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2011', measure: 39.32,sales:'Global Sale : 39.32million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2012', measure: 46.65,sales:'Global Sale : 46.65million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2013', measure: 38.44,sales:'Global Sale : 38.44million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2014', measure: 37.32,sales:'Global Sale : 37.32million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Nintendo',category :'2015', measure: 22.51,sales:'Global Sale : 22.51million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2000', measure: 5.65,sales:'Global Sale : 5.65million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2001', measure: 1.82,sales:'Global Sale : 1.82million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2002', measure: 9.54,sales:'Global Sale : 9.54million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2003', measure: 8.4,sales:'Global Sale : 8.4million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2004', measure: 4.76,sales:'Global Sale : 4.76million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2005', measure: 10.81,sales:'Global Sale : 10.81million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2006', measure: 10.33,sales:'Global Sale : 10.33million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2007', measure: 6.75,sales:'Global Sale : 6.75million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2008', measure: 9.2,sales:'Global Sale : 9.2million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2009', measure: 13.99,sales:'Global Sale : 13.99million $<br>',msg:'Critically acclaimed game Demon Souls was released',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2010', measure: 15.19,sales:'Global Sale : 15.19million $<br>',msg:'Dragon Ball : Raging Blast 2 and Naruto Shipuden were both commercial successes',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2011', measure: 20.01,sales:'Global Sale : 20.01million $<br>',msg:'Witcher 2 sold over 4 million copies ',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2012', measure: 14.73,sales:'Global Sale : 14.73million $<br>',msg:'Tekken Tag Tournament 2 became a huge success for the arcade market',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2013', measure: 9.0,sales:'Global Sale : 9.0million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2014', measure: 8.32,sales:'Global Sale : 8.32million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Namco Bandai',category :'2015', measure: 11.83,sales:'Global Sale : 11.83million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2000', measure: 2.07,sales:'Global Sale : 2.07million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2001', measure: 4.04,sales:'Global Sale : 4.04million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2002', measure: 10.49,sales:'Global Sale : 10.49million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2003', measure: 9.57,sales:'Global Sale : 9.57million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2004', measure: 9.03,sales:'Global Sale : 9.03million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2005', measure: 8.44,sales:'Global Sale : 8.44million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2006', measure: 13.54,sales:'Global Sale : 13.54million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2007', measure: 12.86,sales:'Global Sale : 12.86million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2008', measure: 32.05,sales:'Global Sale : 32.05million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2009', measure: 20.34,sales:'Global Sale : 20.34million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2010', measure: 20.92,sales:'Global Sale : 20.92million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2011', measure: 13.01,sales:'Global Sale : 13.01million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2012', measure: 8.04,sales:'Global Sale : 8.04million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2013', measure: 4.46,sales:'Global Sale : 4.46million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2014', measure: 4.51,sales:'Global Sale : 4.51million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Sega',category :'2015', measure: 1.24,sales:'Global Sale : 1.24million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2000', measure: 3.96,sales:'Global Sale : 3.96million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2001', measure: 4.39,sales:'Global Sale : 4.39million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2002', measure: 13.19,sales:'Global Sale : 13.19million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2003', measure: 14.24,sales:'Global Sale : 14.24million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2004', measure: 13.76,sales:'Global Sale : 13.76million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2005', measure: 14.45,sales:'Global Sale : 14.45million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2006', measure: 15.31,sales:'Global Sale : 15.31million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2007', measure: 43.05,sales:'Global Sale : 43.05million $<br>',msg:'Assassins Creed sold over 7 million copies',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2008', measure: 55.02,sales:'Global Sale : 55.02million $<br>',msg:'Multiple commercial success like SoulCaliber 4, Rayman Raving Rabbids and Far Cry 2',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2009', measure: 39.74,sales:'Global Sale : 39.74million $<br>',msg:'Assassins Creed 2 was named Action game of the year and sold over 6 million copies',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2010', measure: 33.1,sales:'Global Sale : 33.1million $<br>',msg:'Assassins Creed BRotherhood became Ubisoft best selling',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2011', measure: 33.53,sales:'Global Sale : 33.53million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2012', measure: 30.4,sales:'Global Sale : 30.4million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2013', measure: 23.5,sales:'Global Sale : 23.5million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2014', measure: 37.81,sales:'Global Sale : 37.81million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Ubisoft',category :'2015', measure: 9.51,sales:'Global Sale : 9.51million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2000', measure: 22.14,sales:'Global Sale : 22.14million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2001', measure: 41.39,sales:'Global Sale : 41.39million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2002', measure: 66.18,sales:'Global Sale : 66.18million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2003', measure: 62.63,sales:'Global Sale : 62.63million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2004', measure: 60.43,sales:'Global Sale : 60.43million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2005', measure: 62.1,sales:'Global Sale : 62.1million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2006', measure: 53.92,sales:'Global Sale : 53.92million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2007', measure: 67.64,sales:'Global Sale : 67.64million $<br>',msg:'The Orange Box was both a critical and commercial success',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2008', measure: 80.6,sales:'Global Sale : 80.6million $<br>',msg:'Multiple Commercial success like FIFA 09, Dead Space & NFS:Undercover ',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2009', measure: 78.09,sales:'Global Sale : 78.09million $<br>',msg:'Multiple Commercial success like FIFA 10, Left4Dead 2 & NFS:Shift',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2010', measure: 76.3,sales:'Global Sale : 76.3million $<br>',msg:'BattleField Bad Company 2 sold over 8 million copies',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2011', measure: 64.91,sales:'Global Sale : 64.91million $<br>',msg:'FIFA 2012 became the fastest selling sports game',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2012', measure: 41.66,sales:'Global Sale : 41.66million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2013', measure: 46.02,sales:'Global Sale : 46.02million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2014', measure: 40.21,sales:'Global Sale : 40.21million $<br>',msg:'',msg2:'',cond:'yes'},
{group:'Electronic Arts',category :'2015', measure: 29.26,sales:'Global Sale : 29.26million $<br>',msg:'',msg2:'',cond:'yes'}
]

// set initial group value
var group = 'Electronic Arts';

function datasetBarChosen(group) {
  var ds = [];
  for (x in datasetBarChart) {
     if(datasetBarChart[x].group==group){
      ds.push(datasetBarChart[x]);
     } 
    }
  return ds;
}


function dsBarChartBasics() {

    var margin = {top: 40, right: 5, bottom: 50, left: 50},
    width = 1000 - margin.left - margin.right,
     height = 250 - margin.top - margin.bottom,
    colorBar = d3.scale.category20(),
    barPadding = 4
    ;
    
    return {
      margin : margin, 
      width : width, 
      height : height, 
      colorBar : colorBar, 
      barPadding : barPadding
    }     
    ;
}

function dsBarChart() {

  var firstDatasetBarChart = datasetBarChosen(group);           
  
  var basics = dsBarChartBasics();
  
  var margin = basics.margin,
    width = basics.width,
     height = basics.height,
    colorBar = basics.colorBar,
    barPadding = basics.barPadding
    ;
          
  var   xScale = d3.scale.linear()
            .domain([0, firstDatasetBarChart.length])
            .range([0, width])
            ;
            
  // Create linear y scale 
  // Purpose: No matter what the data is, the bar should fit into the svg area; bars should not
  // get higher than the svg height. Hence incoming data needs to be scaled to fit into the svg area.  
  var yScale = d3.scale.linear()
      // use the max funtion to derive end point of the domain (max value of the dataset)
      // do not use the min value of the dataset as min of the domain as otherwise you will not see the first bar
       .domain([0, d3.max(firstDatasetBarChart, function(d) { return d.measure; })])
       // As coordinates are always defined from the top left corner, the y position of the bar
       // is the svg height minus the data value. So you basically draw the bar starting from the top. 
       // To have the y position calculated by the range function
       .range([height, 0])
       ;
  
  var tip_show = '';
  //Create SVG element
     var tip = d3.tip()
        .attr('class','d3-tip')
        .offset([-10, 0])
        .html(function(d) {
        if(d.cond.localeCompare('no'))
        {
          return  "<strong> <span style='color:white'>"+d.sales+'<br>'+d.msg+"</span>";
        }
        })
  
  var svg = d3.select("#barChart")
      .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .attr("id","barChartPlot")
        ;
  
  var plot = svg
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
        ;
 svg.call(tip);
  plot.selectAll("rect")
       .data(firstDatasetBarChart)
       .enter()
       .append("rect")
      .attr("x", function(d, i) {
          return xScale(i);
      })
       .attr("width", width / firstDatasetBarChart.length - barPadding)   
      .attr("y", function(d) {
          return yScale(d.measure);
      })  
      .attr("height", function(d) {
          return height-yScale(d.measure);
      })
      .attr("fill", "grey")
      .on('mouseover', tip.show)
      .on('mouseout', tip.hide)
      ;
  
    // svg.selectAll("text.label")
    //     .data(input.filter(function(d) { return d.cond.localeCompare('no') }))
    //     .enter().append("text")
    //     .attr("class", "label")
    //     .attr("x", function (d) {
    //         return xScale(d.keyword) + xScale.rangeBand()/2;
    //     }).attr("y", function (d) {
    //         return yScale(d.global) - 25;
    //     })
    //     .style("text-anchor", "middle")
    //     .text("Class average");

  // Add y labels to plot 
  
  plot.selectAll("text")
  .data(firstDatasetBarChart)
  .enter()
  .append("text")
  .text(function(d) {
      return formatAsInteger(d3.round(d.measure));
  })
  .attr("text-anchor", "middle")
  // Set x position to the left edge of each bar plus half the bar width
  .attr("x", function(d, i) {
      return (i * (width / firstDatasetBarChart.length)) + ((width / firstDatasetBarChart.length - barPadding) / 2);
  })
  .attr("y", function(d) {
      return yScale(d.measure) - 5;
  })
  .attr("class", "yAxis")
  ;
  
  // Add x labels to chart  
  
var y = d3.scale.ordinal()
    .rangeRoundBands([0, height], .1);

var x = d3.scale.linear()
    .range([0, width]);

  var xLabels = svg
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + (margin.top + height)  + ")")
        ;
  
  xLabels.selectAll("text.xAxis")
      .data(firstDatasetBarChart)
      .enter()
      .append("text")
      .text(function(d) { return d.category;})
      .attr("text-anchor", "middle")
      // Set x position to the left edge of each bar plus half the bar width
               .attr("x", function(d, i) {
                  return (i * (width / firstDatasetBarChart.length)) + ((width / firstDatasetBarChart.length - barPadding) / 2);
               })
      .attr("y", 15)
      .attr("class", "xAxis")
      ;     
   
  // Title
  
  svg.append("text")
    .attr("x", (margin.left + margin.right)/2)
    .attr("y", 10)
    .attr("class","title")        
    .attr("text-anchor", "left")
    .text("Global Sales Breakdown (Year Wise (in millions $))")
    ;

// svg.append("text")
//         .attr("x", (width / 2))             
//         .attr("y", 0 - (margin.top / 2))
//         .attr("text-anchor", "middle")  
//         .style("font-size", "16px") 
//         .style("text-decoration", "underline")  
//         .text("Value vs Date Graph");

  svg.append("text")
    .attr("x", (width + margin.left + margin.right)/2)
    .attr("y", 245)
    .attr("class","xAxis")        
    .attr("text-anchor", "middle")
    .text("Year")
    ;

   
}

dsBarChart();

 /* ** UPDATE CHART ** */
 
/* updates bar chart on request */

function updateBarChart(group, colorChosen) {
  
    var currentDatasetBarChart = datasetBarChosen(group);
    
    var basics = dsBarChartBasics();
  
    var margin = basics.margin,
      width = basics.width,
       height = basics.height,
      colorBar = basics.colorBar,
      barPadding = basics.barPadding
      ;
    
    var   xScale = d3.scale.linear()
      .domain([0, currentDatasetBarChart.length])
      .range([0, width])
      ;
    
      
        console.log(group);
    var yScale = d3.scale.linear()
        .domain([0, d3.max(currentDatasetBarChart, function(d) { return d.measure; })])
        .range([height,0])
        ;
        
     var svg = d3.select("#barChart svg");
        
     var plot = d3.select("#barChartPlot")
      .datum(currentDatasetBarChart)
       ;
  
        /* Note that here we only have to select the elements - no more appending! */
      plot.selectAll("rect")
        .data(currentDatasetBarChart)
        .transition()
      .duration(750)
      .attr("x", function(d, i) {
          return xScale(i);
      })
       .attr("width", width / currentDatasetBarChart.length - barPadding)   
      .attr("y", function(d) {
          return yScale(d.measure);
      })  
      .attr("height", function(d) {
          return height-yScale(d.measure);
      })
      .attr("fill", colorChosen)
      ;
    
    plot.selectAll("text.yAxis") // target the text element(s) which has a yAxis class defined
      .data(currentDatasetBarChart)
      .transition()
      .duration(750)
       .attr("text-anchor", "middle")
       .attr("x", function(d, i) {
          return (i * (width / currentDatasetBarChart.length)) + ((width / currentDatasetBarChart.length - barPadding) / 2);
       })
       .attr("y", function(d) {
          return yScale(d.measure) - 5;
       })
       .text(function(d) {
        return formatAsInteger(d3.round(d.measure));
       })
       .attr("class", "yAxis")          
    ;

    svg.selectAll("text.title") // target the text element(s) which has a title class defined
      .attr("x", (margin.left + margin.right)/2)
      .attr("y", 15)
      .attr("class","title")        
      .attr("text-anchor", "left")
      .text(group + "'s Sales Breakdown (Year wise in million $)")
    ;
}


/*
############# LINE CHART ##################
-------------------------------------------
*/
/*
var datasetLineChart = [
{ group: "All", category: 2010, measure: 289309 }, 
{ group: "All", category: 2011, measure: 234998 }, 
{ group: "All", category: 2012, measure: 310900 }, 
{ group: "All", category: 2013, measure: 223900 }, 
{ group: "All", category: 2014, measure: 234500 }, 
{ group: "Sam", category: 2010, measure: 81006.52 }, 
{ group: "Sam", category: 2011, measure: 70499.4 }, 
{ group: "Sam", category: 2012, measure: 96379 }, 
{ group: "Sam", category: 2013, measure: 64931 }, 
{ group: "Sam", category: 2014, measure: 70350 }, 
{ group: "Peter", category: 2010, measure: 63647.98 }, 
{ group: "Peter", category: 2011, measure: 61099.48 }, 
{ group: "Peter", category: 2012, measure: 87052 }, 
{ group: "Peter", category: 2013, measure: 58214 }, 
{ group: "Peter", category: 2014, measure: 58625 }, 
{ group: "Rick", category: 2010, measure: 23144.72 }, 
{ group: "Rick", category: 2011, measure: 14099.88 }, 
{ group: "Rick", category: 2012, measure: 15545 }, 
{ group: "Rick", category: 2013, measure: 11195 }, 
{ group: "Rick", category: 2014, measure: 11725 }, 
{ group: "Jenn", category: 2010, measure: 34717.08 }, 
{ group: "Jenn", category: 2011, measure: 30549.74 }, 
{ group: "Jenn", category: 2012, measure: 34199 }, 
{ group: "Jenn", category: 2013, measure: 33585 }, 
{ group: "Jenn", category: 2014, measure: 35175 }, 
{ group: "Laura", category: 2010, measure: 69434.16 }, 
{ group: "Laura", category: 2011, measure: 46999.6 }, 
{ group: "Laura", category: 2012, measure: 62180 }, 
{ group: "Laura", category: 2013, measure: 40302 }, 
{ group: "Laura", category: 2014, measure: 42210 }, 
{ group: "Mike", category: 2010, measure: 7232.725 }, 
{ group: "Mike", category: 2011, measure: 4699.96 }, 
{ group: "Mike", category: 2012, measure: 6218 }, 
{ group: "Mike", category: 2013, measure: 8956 }, 
{ group: "Mike", category: 2014, measure: 9380 }, 
{ group: "Steve", category: 2010, measure: 10125.815 }, 
{ group: "Steve", category: 2011, measure: 7049.94 }, 
{ group: "Steve", category: 2012, measure: 9327 }, 
{ group: "Steve", category: 2013, measure: 6717 }, 
{ group: "Steve", category: 2014, measure: 7035 }
];
*/
var datasetLineChart = [
{group:'Take 2 Interactive',category :'2016', measure: 11},
{group:'Take 2 Interactive',category :'2000', measure: 5},
{group:'Take 2 Interactive',category :'2001', measure: 11},
{group:'Take 2 Interactive',category :'2002', measure: 7},
{group:'Take 2 Interactive',category :'2003', measure: 13},
{group:'Take 2 Interactive',category :'2004', measure: 11},
{group:'Take 2 Interactive',category :'2005', measure: 40},
{group:'Take 2 Interactive',category :'2006', measure: 32},
{group:'Take 2 Interactive',category :'2007', measure: 36},
{group:'Take 2 Interactive',category :'2008', measure: 40},
{group:'Take 2 Interactive',category :'2009', measure: 40},
{group:'Take 2 Interactive',category :'2010', measure: 34},
{group:'Take 2 Interactive',category :'2011', measure: 30},
{group:'Take 2 Interactive',category :'2012', measure: 27},
{group:'Take 2 Interactive',category :'2013', measure: 14},
{group:'Take 2 Interactive',category :'2014', measure: 14},
{group:'Take 2 Interactive',category :'2015', measure: 16},
{group:'Sony Entertainment',category :'2016', measure: 4},
{group:'Sony Entertainment',category :'2000', measure: 31},
{group:'Sony Entertainment',category :'2001', measure: 36},
{group:'Sony Entertainment',category :'2002', measure: 29},
{group:'Sony Entertainment',category :'2003', measure: 31},
{group:'Sony Entertainment',category :'2004', measure: 29},
{group:'Sony Entertainment',category :'2005', measure: 47},
{group:'Sony Entertainment',category :'2006', measure: 50},
{group:'Sony Entertainment',category :'2007', measure: 40},
{group:'Sony Entertainment',category :'2008', measure: 36},
{group:'Sony Entertainment',category :'2009', measure: 44},
{group:'Sony Entertainment',category :'2010', measure: 42},
{group:'Sony Entertainment',category :'2011', measure: 35},
{group:'Sony Entertainment',category :'2012', measure: 23},
{group:'Sony Entertainment',category :'2013', measure: 11},
{group:'Sony Entertainment',category :'2014', measure: 12},
{group:'Sony Entertainment',category :'2015', measure: 9},
{group:'Konami',category :'2016', measure: 7},
{group:'Konami',category :'2000', measure: 30},
{group:'Konami',category :'2001', measure: 37},
{group:'Konami',category :'2002', measure: 54},
{group:'Konami',category :'2003', measure: 26},
{group:'Konami',category :'2004', measure: 41},
{group:'Konami',category :'2005', measure: 55},
{group:'Konami',category :'2006', measure: 65},
{group:'Konami',category :'2007', measure: 60},
{group:'Konami',category :'2008', measure: 63},
{group:'Konami',category :'2009', measure: 58},
{group:'Konami',category :'2010', measure: 67},
{group:'Konami',category :'2011', measure: 43},
{group:'Konami',category :'2012', measure: 31},
{group:'Konami',category :'2013', measure: 15},
{group:'Konami',category :'2014', measure: 17},
{group:'Konami',category :'2015', measure: 11},
{group:'Activision',category :'2016', measure: 13},
{group:'Activision',category :'2000', measure: 12},
{group:'Activision',category :'2001', measure: 22},
{group:'Activision',category :'2002', measure: 49},
{group:'Activision',category :'2003', measure: 33},
{group:'Activision',category :'2004', measure: 46},
{group:'Activision',category :'2005', measure: 69},
{group:'Activision',category :'2006', measure: 49},
{group:'Activision',category :'2007', measure: 74},
{group:'Activision',category :'2008', measure: 87},
{group:'Activision',category :'2009', measure: 120},
{group:'Activision',category :'2010', measure: 88},
{group:'Activision',category :'2011', measure: 73},
{group:'Activision',category :'2012', measure: 41},
{group:'Activision',category :'2013', measure: 37},
{group:'Activision',category :'2014', measure: 41},
{group:'Activision',category :'2015', measure: 38},
{group:'Nintendo',category :'2016', measure: 9},
{group:'Nintendo',category :'2000', measure: 22},
{group:'Nintendo',category :'2001', measure: 21},
{group:'Nintendo',category :'2002', measure: 21},
{group:'Nintendo',category :'2003', measure: 26},
{group:'Nintendo',category :'2004', measure: 56},
{group:'Nintendo',category :'2005', measure: 44},
{group:'Nintendo',category :'2006', measure: 51},
{group:'Nintendo',category :'2007', measure: 41},
{group:'Nintendo',category :'2008', measure: 31},
{group:'Nintendo',category :'2009', measure: 31},
{group:'Nintendo',category :'2010', measure: 27},
{group:'Nintendo',category :'2011', measure: 25},
{group:'Nintendo',category :'2012', measure: 30},
{group:'Nintendo',category :'2013', measure: 22},
{group:'Nintendo',category :'2014', measure: 19},
{group:'Nintendo',category :'2015', measure: 31},
{group:'Namco Bandai',category :'2016', measure: 39},
{group:'Namco Bandai',category :'2000', measure: 13},
{group:'Namco Bandai',category :'2001', measure: 10},
{group:'Namco Bandai',category :'2002', measure: 24},
{group:'Namco Bandai',category :'2003', measure: 22},
{group:'Namco Bandai',category :'2004', measure: 24},
{group:'Namco Bandai',category :'2005', measure: 40},
{group:'Namco Bandai',category :'2006', measure: 65},
{group:'Namco Bandai',category :'2007', measure: 48},
{group:'Namco Bandai',category :'2008', measure: 51},
{group:'Namco Bandai',category :'2009', measure: 61},
{group:'Namco Bandai',category :'2010', measure: 69},
{group:'Namco Bandai',category :'2011', measure: 75},
{group:'Namco Bandai',category :'2012', measure: 84},
{group:'Namco Bandai',category :'2013', measure: 62},
{group:'Namco Bandai',category :'2014', measure: 68},
{group:'Namco Bandai',category :'2015', measure: 67},
{group:'Sega',category :'2016', measure: 7},
{group:'Sega',category :'2000', measure: 10},
{group:'Sega',category :'2001', measure: 8},
{group:'Sega',category :'2002', measure: 38},
{group:'Sega',category :'2003', measure: 31},
{group:'Sega',category :'2004', measure: 27},
{group:'Sega',category :'2005', measure: 30},
{group:'Sega',category :'2006', measure: 46},
{group:'Sega',category :'2007', measure: 48},
{group:'Sega',category :'2008', measure: 66},
{group:'Sega',category :'2009', measure: 42},
{group:'Sega',category :'2010', measure: 38},
{group:'Sega',category :'2011', measure: 34},
{group:'Sega',category :'2012', measure: 24},
{group:'Sega',category :'2013', measure: 16},
{group:'Sega',category :'2014', measure: 22},
{group:'Sega',category :'2015', measure: 9},
{group:'Ubisoft',category :'2016', measure: 12},
{group:'Ubisoft',category :'2000', measure: 20},
{group:'Ubisoft',category :'2001', measure: 24},
{group:'Ubisoft',category :'2002', measure: 43},
{group:'Ubisoft',category :'2003', measure: 46},
{group:'Ubisoft',category :'2004', measure: 31},
{group:'Ubisoft',category :'2005', measure: 56},
{group:'Ubisoft',category :'2006', measure: 60},
{group:'Ubisoft',category :'2007', measure: 87},
{group:'Ubisoft',category :'2008', measure: 111},
{group:'Ubisoft',category :'2009', measure: 101},
{group:'Ubisoft',category :'2010', measure: 71},
{group:'Ubisoft',category :'2011', measure: 85},
{group:'Ubisoft',category :'2012', measure: 31},
{group:'Ubisoft',category :'2013', measure: 28},
{group:'Ubisoft',category :'2014', measure: 43},
{group:'Ubisoft',category :'2015', measure: 31},
{group:'Electronic Arts',category :'2016', measure: 19},
{group:'Electronic Arts',category :'2000', measure: 30},
{group:'Electronic Arts',category :'2001', measure: 42},
{group:'Electronic Arts',category :'2002', measure: 87},
{group:'Electronic Arts',category :'2003', measure: 84},
{group:'Electronic Arts',category :'2004', measure: 85},
{group:'Electronic Arts',category :'2005', measure: 116},
{group:'Electronic Arts',category :'2006', measure: 101},
{group:'Electronic Arts',category :'2007', measure: 106},
{group:'Electronic Arts',category :'2008', measure: 119},
{group:'Electronic Arts',category :'2009', measure: 111},
{group:'Electronic Arts',category :'2010', measure: 87},
{group:'Electronic Arts',category :'2011', measure: 75},
{group:'Electronic Arts',category :'2012', measure: 45},
{group:'Electronic Arts',category :'2013', measure: 41},
{group:'Electronic Arts',category :'2014', measure: 35},
{group:'Electronic Arts',category :'2015', measure: 30}
];


function sortByDateAscending(a, b) {
    // Dates will be cast to numbers automagically:
    return a.category - b.category;
}

datasetLineChart = datasetLineChart.sort(sortByDateAscending);
// set initial category value
var group = 'Take 2 Interactive';

function datasetLineChartChosen(group) {
  var ds = [];
  for (x in datasetLineChart) {
     if(datasetLineChart[x].group==group){
      ds.push(datasetLineChart[x]);
     } 
    }
  return ds;
}

function dsLineChartBasics() {

  var margin = {top: 20, right: 10, bottom: 0, left: 50},
      width = 800 - margin.left - margin.right,
      height = 150 - margin.top - margin.bottom
      ;
    
    return {
      margin : margin, 
      width : width, 
      height : height
    }     
    ;
}


function dsLineChart() {

  var firstDatasetLineChart = datasetLineChartChosen(group);    
  
  var basics = dsLineChartBasics();
  
  var margin = basics.margin,
    width = basics.width,
     height = basics.height
    ;

  var xScale = d3.scale.linear()
      .domain([0, firstDatasetLineChart.length-1])
      .range([0, width])
      ;

  var yScale = d3.scale.linear()
      .domain([0, d3.max(firstDatasetLineChart, function(d) { return d.measure; })])
      .range([height, 0])
      ;


  var line = d3.svg.line()
      //.x(function(d) { return xScale(d.category); })
      .x(function(d, i) { return xScale(i); })
      .y(function(d) { return yScale(d.measure); })
      ;

  // Define the div for the tooltip
  var div = d3.select("body").append("div") 
    .attr("class", "tooltip")       
    .style("opacity", 0);
  
  var svg = d3.select("#lineChart").append("svg")
      .datum(firstDatasetLineChart)
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom);
      // create group and move it so that margins are respected (space for axis and title)
      
  var plot = svg
      .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
      .attr("id", "lineChartPlot")
      ;

    /* descriptive titles as part of plot -- start */
  var dsLength=firstDatasetLineChart.length;

  plot.append("text")
    .text("Number of relasese by "+firstDatasetLineChart[dsLength-1].group)
    .attr("id","lineChartTitle2")
    .attr("x",width/2)
    .attr("y",height/2) 
    ;
  /* descriptive titles -- end */
      
  plot.append("path")
      .attr("class", "line")
      .attr("d", line)  
      // add color
    .attr("stroke", "lightgrey")
      ;
    
  plot.selectAll(".dot")
      .data(firstDatasetLineChart)
       .enter().append("circle")
      .attr("class", "dot")
      //.attr("stroke", function (d) { return d.measure==datasetMeasureMin ? "red" : (d.measure==datasetMeasureMax ? "green" : "steelblue") } )
      .attr("fill", function (d) { return d.measure==d3.min(firstDatasetLineChart, function(d) { return d.measure; }) ? "red" : (d.measure==d3.max(firstDatasetLineChart, function(d) { return d.measure; }) ? "green" : "white") } )
      //.attr("stroke-width", function (d) { return d.measure==datasetMeasureMin || d.measure==datasetMeasureMax ? "3px" : "1.5px"} )
      .attr("cx", line.x())
      .attr("cy", line.y())
      .attr("r", 3.5)
      .attr("stroke", "lightgrey")
      .append("title")
      .text(function(d) { return d.category + ": " + formatAsInteger(d.measure); })
      ;

  plot.selectAll(".dot")
        .on("mouseover", function(d) {    
            div.transition()    
                .duration(200)    
                .style("opacity", .9);    
            div .html("Year: "+d.category + "<br/>" +"Sales: "+ d.measure +" ( mil. $ )")  
                .style("left", (d3.event.pageX) + "px")   
                .style("top", (d3.event.pageY) + "px");  
            })          
        .on("mouseout", function(d) {   
            div.transition()    
                .duration(500)    
                .style("opacity", 0); 
        });

  svg.append("text")
    .text("Number of Releases per year")
    .attr("id","lineChartTitle1") 
    .attr("x",margin.left + ((width + margin.right)/2))
    .attr("y", 10)
    .style("font-size",14)
    ;

}

dsLineChart();


 /* ** UPDATE CHART ** */
 
/* updates bar chart on request */
function updateLineChart(group, colorChosen) {

  var currentDatasetLineChart = datasetLineChartChosen(group);   

  var basics = dsLineChartBasics();
  
  var margin = basics.margin,
    width = basics.width,
     height = basics.height
    ;

  var xScale = d3.scale.linear()
      .domain([0, currentDatasetLineChart.length-1])
      .range([0, width])
      ;

  var yScale = d3.scale.linear()
      .domain([0, d3.max(currentDatasetLineChart, function(d) { return d.measure; })])
      .range([height, 0])
      ;
  
  var line = d3.svg.line()
    .x(function(d, i) { return xScale(i); })
    .y(function(d) { return yScale(d.measure); })
    ;

   var plot = d3.select("#lineChartPlot")
    .datum(currentDatasetLineChart)
     ;
     
  /* descriptive titles as part of plot -- start */
  var dsLength=currentDatasetLineChart.length;
  
  plot.select("text")
    .text(currentDatasetLineChart[dsLength-1].group)
    .style('font-color','black')
    ;
  /* descriptive titles -- end */
     
  plot
  .select("path")
    .transition()
    .duration(750)          
     .attr("class", "line")
     .attr("d", line) 
     // add color
    .attr("stroke", colorChosen)
     ;
     
  var path = plot
    .selectAll(".dot")
     .data(currentDatasetLineChart)
     .transition()
    .duration(750)
     .attr("class", "dot")
     .attr("fill", function (d) { return d.measure==d3.min(currentDatasetLineChart, function(d) { return d.measure; }) ? "red" : (d.measure==d3.max(currentDatasetLineChart, function(d) { return d.measure; }) ? "green" : "white") } )
     .attr("cx", line.x())
     .attr("cy", line.y())
     .attr("r", 3.5)
     // add color
    .attr("stroke", colorChosen)
     ;

    path.selectAll(".dot")
        .on("mouseover", function(d) {    
            div.transition()    
                .duration(200)    
                .style("opacity", .9);    
            div .html("Year: "+d.category + "<br/>"+ "Sales: " + d.measure + " ( mil. $ )")  
                .style("left", (d3.event.pageX) + "px")   
                .style("top", (d3.event.pageY) + "px");  
            })          
        .on("mouseout", function(d) {   
            div.transition()    
                .duration(500)    
                .style("opacity", 0); 
        });
     
     path
     .selectAll("title")
     .text(function(d) { return d.category + ": " + formatAsInteger(d.measure); })   
     ;  

}

    </script>
  </body>
</html>